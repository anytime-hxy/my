!function(e){e.widget("ui.droppable",{_init:function(){var t=this.options,i=t.accept;this.isover=0,this.isout=1,this.options.accept=this.options.accept&&e.isFunction(this.options.accept)?this.options.accept:function(e){return e.is(i)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[this.options.scope]=e.ui.ddmanager.droppables[this.options.scope]||[],e.ui.ddmanager.droppables[this.options.scope].push(this),this.options.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var t=e.ui.ddmanager.droppables[this.options.scope],i=0;i<t.length;i++)t[i]==this&&t.splice(i,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable")},_setData:function(t,i){"accept"==t?this.options.accept=i&&e.isFunction(i)?i:function(e){return e.is(i)}:e.widget.prototype._setData.apply(this,arguments)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!=this.element[0]&&this.options.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!=this.element[0]&&this.options.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current;if(!s||(s.currentItem||s.element)[0]==this.element[0])return!1;var o=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"droppable");return t.options.greedy&&e.ui.intersect(s,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(o=!0,!1):void 0}),o?!1:this.options.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,absolutePosition:e.positionAbs,offset:e.positionAbs}}}),e.extend(e.ui.droppable,{version:"1.7.1",eventPrefix:"drop",defaults:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"}}),e.ui.intersect=function(t,i,s){if(!i.offset)return!1;var o=(t.positionAbs||t.position.absolute).left,n=o+t.helperProportions.width,r=(t.positionAbs||t.position.absolute).top,a=r+t.helperProportions.height,p=i.offset.left,l=p+i.proportions.width,h=i.offset.top,c=h+i.proportions.height,d=e("#show_panel").offset().left,u=e("#show_panel").offset().left+e("#show_panel").width();switch(s){case"fit":return r>h&&c>a&&(o>p&&l>n||d>o&&n>l||p>o&&n>u);case"intersect":return p<o+t.helperProportions.width/2&&n-t.helperProportions.width/2<l&&h<r+t.helperProportions.height/2&&a-t.helperProportions.height/2<c;case"pointer":var f=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,m=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,v=e.ui.isOver(m,f,h,p,i.proportions.height,i.proportions.width);return v;case"touch":return(r>=h&&c>=r||a>=h&&c>=a||h>r&&a>c)&&(o>=p&&l>=o||n>=p&&l>=n||p>o&&n>l);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s=e.ui.ddmanager.droppables[t.options.scope],o=i?i.type:null,n=(t.currentItem||t.element).find(":data(droppable)").andSelf();e:for(var r=0;r<s.length;r++)if(!(s[r].options.disabled||t&&!s[r].options.accept.call(s[r].element[0],t.currentItem||t.element))){for(var a=0;a<n.length;a++)if(n[a]==s[r].element[0]){s[r].proportions.height=0;continue e}s[r].visible="none"!=s[r].element.css("display"),s[r].visible&&(s[r].offset=s[r].element.offset(),s[r].proportions={width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight},"mousedown"==o&&s[r]._activate.call(s[r],i))}},drop:function(t,i){var s=!1;return e.each(e.ui.ddmanager.droppables[t.options.scope],function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(s=this._drop.call(this,i)),!this.options.disabled&&this.visible&&this.options.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,i)))}),s},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s=e.ui.intersect(t,this,this.options.tolerance),o=s||1!=this.isover?s&&0==this.isover?"isover":null:"isout";if(o){var n;if(this.options.greedy){var r=this.element.parents(":data(droppable):eq(0)");r.length&&(n=e.data(r[0],"droppable"),n.greedyChild="isover"==o?1:0)}n&&"isover"==o&&(n.isover=0,n.isout=1,n._out.call(n,i)),this[o]=1,this["isout"==o?"isover":"isout"]=0,this["isover"==o?"_over":"_out"].call(this,i),n&&"isout"==o&&(n.isout=0,n.isover=1,n._over.call(n,i))}}})}}}(jQuery);